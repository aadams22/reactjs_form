<html>
<head>
  <title></title>
  <link rel="stylesheet" type="text/css" href="./styles/main.css">
</head>
<body>
<div id="error-handler"></div>
<div id="login-container"></div>

    <script src="https://fb.me/react-15.0.0.js"></script>
    <script src="https://fb.me/react-dom-15.0.0.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.34/browser.min.js"></script>
    <script type="text/babel">

      var data = [];

      var FormInput = React.createClass({
          getInitialState: function() {
            return {
              firstname: '', 
              email: '',
              success: false,
              isValid: true
            };
          },
          handleNameChange: function(e) {
            this.setState({firstname: e.target.value});
          },
          handleEmailChange: function(e) {
            this.setState({email: e.target.value});
          },
          handleSubmit: function(e) {
            e.preventDefault();
            this.setState({success: true});

            console.log('validate email: ', this.validateEmail);
            console.log(this.validation.email);

            var firstName  = this.state.firstname.trim();
            var email      = this.state.email.trim();

            if(!firstName || !email ) { return; }


            /*Normally an AJAX call would be here sending the data to the server, on success the data array would be updated, but since we're dealing with only 2 pieces of information and no db, no array or ajax call is necessary*/
            if(isValid) {
             data.push({'firstName': firstName, 'email': email});
              console.log('data: ', data);             
            }


            /*on a successful ajax call, this should be the final code to reset inupts to empty values
            return this.setState({firstname: '', email: '', success: false});*/
          },
          isEmpty: function(e) {
            console.log('isEmpty');
            if (this.props.required && !this.props.value) {
              console.log('this.props.required && !this.props.value');
              return this.setState({ isValid: false});
            }
          },
          validateEmail: function(state) {
            /*would probably use a stronger regex and include sending an email for physical validation*/
            return { email: /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(state.email) }
          },
          validateName: function(state) {
            //tests for only letters in name. includes German characters
            //!!need to include French and Spanish
            return { firstname: /[a-zA-ZäöüßÄÖÜ]/.test(state.firstname) }
          },
          render: function() {
              return (
                <div>

                  {this.state.success && 
                    <UserData 
                      firstname={this.state.firstname} 
                      email={this.state.email} />
                  }
   

                  {!this.state.success &&
                    <form onSubmit={ this.handleSubmit }>
                      <input type="text" 
                              placeholder="Name"
                              value={this.state.firstname} 
                              validation={this.validateName}
                              empty={this.isEmpty}                         
                              onChange={this.handleNameChange}
                              required />
                      <br /><br />
                      <input type="email" 
                             placeholder="example@example.com"
                             value={this.state.email}
                             validation={this.validateEmail}
                             empty={this.isEmpty} 
                             onChange={this.handleEmailChange}
                             required  />
                      <br /><br />
                      <input type="submit" value="Post"></input>
                    </form>
                  }

                </div>
              
              );
          }

        });
      


      var UserData = React.createClass({
        render: function() {
          return (
            <div id="error-handler">
              <h1>We appreciate your support!</h1>
              <h2>{this.props.firstname}</h2>
              <p>{this.props.email}</p>
            </div>
          )
        }

      });

      ReactDOM.render(
        <FormInput/>,
        document.getElementById('login-container')
      );




      var ValidationErr = React.createClass({
        getInitialState: function() {

        },
        componentDidUpdate: function(e) {

        },
        render: function() {

          return (
            <div id="user-data">
              <p>Error: {this.props.emptyMessage}</p>
            </div>
          )
        }
      });


      </script>
</body>
</html>